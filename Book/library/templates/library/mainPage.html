{% extends 'library/base.html' %}
{% load static %}

{% block title %}{% if seo %}{{ seo.title }}{% else %}المكتبة الصوتية{% endif %}{% endblock %}

{% block extra_css %}
{% if seo %}
<meta name="description" content="{{ seo.description }}">
<meta name="keywords" content="{{ seo.keywords }}">
{% endif %}
{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="hero-content">
        <h1>قصص تُروى بصوت …<br>وتُسمع بقلبك</h1>
        <p>اقرأ أو استمع لآلاف القصص الممتعة<br>من كتّاب مبدعين في مختلف الفئات</p>
        <a href="{% url 'Storycate' %}" class="explore-btn">استكشف القصص</a>
    </div>

    <div class="hero-image">
        <img src="{% static 'img/Group 2.png' %}" alt="صورة معبرة عن القصص">
    </div>
</section>

<section class="stories-section">
    <h2 class="section-title">قصص تُروى بصوت … وتُسمع بقلب</h2>

    <div class="stories-scroll-container">
        {% for book in books %}
        <a href="{% url 'description' book.id %}">
            <div class="story-card">
                <img src="{{ book.cover_image.url }}" alt="{{ book.title }}" class="story-image">
                <h3 class="story-title">{{ book.title }}</h3>
                <p class="story-author">{{ book.author }}</p>
                <div class="story-meta">
                    <span>مدة الإستماع: 01:15:00</span>
                    <span>عدد الصفحات: 83</span>
                </div>
                <p class="story-category">{{ book.category.name }}</p>
                <div class="story-actions">
                    <a href="{% url 'listen' book.id %}" class="action-btn listen-btn">استمع</a>
                    <div class="feature-icon">
                        {% if user.is_authenticated %}
                        <a href="{% url 'toggle_favorite' book.id 'main' %}">
                            {% if book.id in favorite_ids %}
                            <img src="{% static 'img/icons8_heart_filled.svg' %}" alt="إزالة من المفضلة">
                            {% else %}
                            <img src="{% static 'img/icons8_heart_2 1.svg' %}" alt="أضف للمفضلة">
                            {% endif %}
                        </a>
                        {% else %}
                        <a href="{% url 'index' %}" title="سجل دخول للإضافة للمفضلة">
                            <img src="{% static 'img/icons8_heart_2 1.svg' %}" alt="أضف للمفضلة">
                        </a>
                        {% endif %}
                    </div>
                    <a href="{% url 'description' book.id %}" class="action-btn read-btn">اقرأ</a>
                </div>
            </div>
        </a>
        {% empty %}
        <p>لا توجد كتب متاحة حالياً.</p>
        {% endfor %}
    </div>
</section>

<section class="features-section">
    <h2 class="features-title">لماذا تختار منصتنا؟</h2>

    <div class="features-grid">
        <div class="feature-box">
            <p class="feature-text">كتّاب من العالم العربي</p>
            <div class="feature-icon">
                <img src="{% static 'img/icons8_World_Map 1.svg' %}" alt="">
            </div>
        </div>

        <div class="feature-box">
            <p class="feature-text">استمع أو اقرأ في أي وقت</p>
            <div class="feature-icon">
                <img src="{% static 'img/icons8_listening_to_music_on_headphones 1.svg' %}" alt="">
            </div>
        </div>

        <div class="feature-box">
            <p class="feature-text">منصة آمنة ومجانية</p>
            <div class="feature-icon">
                <img src="{% static 'img/icons8_multiple_devices 1.svg' %}" alt="">
            </div>
        </div>
    </div>
</section>

<section class="categories-section">
    <h2 class="categories-title">فئات القصص</h2>

    <div class="categories-grid">
        <div class="category-card">
            <div class="category-icon highlight">
                <div class="category-icon-inner">
                    <img src="{% static 'img/icons8_fantasy 1.svg' %}" alt="">
                </div>
            </div>
            <p class="category-name">خيال</p>
        </div>

        <div class="category-card">
            <div class="category-icon">
                <div class="category-icon-inner">
                    <img src="{% static 'img/icons8_roman_soldier_1 1.svg' %}" alt="">
                </div>
            </div>
            <p class="category-name">تاريخي</p>
        </div>

        <div class="category-card">
            <div class="category-icon">
                <div class="category-icon-inner">
                    <img src="{% static 'img/icons8_theatre_mask 1.svg' %}" alt="">
                </div>
            </div>
            <p class="category-name">دراما</p>
        </div>

        <div class="category-card">
            <div class="category-icon">
                <div class="category-icon-inner">
                    <img src="{% static 'img/icons8_children 1.svg' %}" alt="">
                </div>
            </div>
            <p class="category-name">أطفال</p>
        </div>
    </div>
</section>

<section class="join-section">
    <h2 class="join-title">هل أنت كاتب؟ انشر قصصك الآن وابدأ رحلتك معنا</h2>

    <div class="email-input">
        <p class="email-text">البريد الإلكتروني</p>
        <div class="email-icon">
            <img src="{% static 'img/icons8_Email 1.svg' %}" alt="">
        </div>
    </div>

    <a href="#" class="join-btn">انضم ككاتب</a>
</section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', duplicateCardsUntilFull);
</script>
{% endblock %}
